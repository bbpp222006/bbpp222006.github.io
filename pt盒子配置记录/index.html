
<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://bbpp222006.github.io/js/theme.min.js" integrity="sha384-pb++s6uBRKaQv+iAXpgA/H3IlpLZdO14tTwuCI7uXmz4aaZdByoCcM+6BhynMq/1"></script>
  <link rel="stylesheet" href="https://bbpp222006.github.io/abridge.css?h=d34a40bc4242778b5e29" />
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="base" content="https://bbpp222006.github.io" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="theme-color" content="#333333" />
  <meta name="msapplication-TileColor" content="#333333" />
  <link rel="manifest" href="https://bbpp222006.github.io/manifest.min.json" />
  <link rel="mask-icon" href="https://bbpp222006.github.io/safari-pinned-tab.svg" color="#ff9900" />
  <link rel="icon" type="image/svg+xml" href="https://bbpp222006.github.io/favicon.svg" />
  <link rel="apple-touch-icon" sizes="180x180" href="https://bbpp222006.github.io/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="https://bbpp222006.github.io/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="https://bbpp222006.github.io/favicon-16x16.png" />
  <link rel="alternate" type="application/atom+xml" title="Glider的博客 Atom/RSS Feed" href="https://bbpp222006.github.io/atom.xml" />
  <meta name="robots" content="index, follow" />
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <title>pt盒子配置记录 | Glider的博客</title>
  <meta name="author" content="Glider" />
  <meta name="copyright" content="Glider的博客" />
  <meta name="description" content="I thought what I&#x27;d do was,I&#x27;d pretend I was one of those deaf-mutes. or should i?" />
  <link rel="canonical" href="https://bbpp222006.github.io/pt盒子配置记录/" />
  <meta name="keywords" content="Abridge, Abridge.css, Zola, Theme, Zola Theme, getzola, Semantic Html, Fast, lightweight" />
  <meta name="google-site-verification" content="Your Google Site verification code." />
  <meta name="msvalidate.01" content="Your Bing Site verification code." />
  <meta property="og:url" content="https://bbpp222006.github.io/pt盒子配置记录/" />
  <meta name="twitter:url" content="https://bbpp222006.github.io/pt盒子配置记录/" />
  <meta property="og:description" content="I thought what I&#x27;d do was,I&#x27;d pretend I was one of those deaf-mutes. or should i?" />
  <meta name="twitter:description" content="I thought what I&#x27;d do was,I&#x27;d pretend I was one of those deaf-mutes. or should i?" />
  <meta property="og:title" content="pt盒子配置记录 | Glider的博客" />
  <meta name="twitter:title" content="pt盒子配置记录 | Glider的博客" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="https://bbpp222006.github.io/banner.png" />
  <meta property="og:image" content="https://bbpp222006.github.io/banner.png" />
  <meta property="og:site_name" content="Glider的博客" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:type" content="website" />
  <meta property="og:updated_time" content="2021-09-27" />
  <meta name="twitter:site" content="@your-user-name" />
  <meta name="twitter:creator" content="@your-user-name" />
  <script defer src="https://bbpp222006.github.io/js/abridge.min.js?h=1a12cf684ae4ed40434f" integrity="sha384-ZsreuwU2rKTp7gC4bTf5sYz+3AjMym99XDa/B5wa08fCzLVVX+NDaTsTeyLXseDG"></script>
  <noscript><link rel="stylesheet" href="https://bbpp222006.github.io/nojs.css" /></noscript>
</head>
<body>
  <header>
    <nav>
      <div><h1><a href="https://bbpp222006.github.io" title="Glider的博客"><svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="#f90" viewBox="0 0 96 96" width="28" height="28"><path stroke-width="14" d="M14 99 46 7h4l32 92"/><path stroke-width="9" d="M-3 82c43-26 59-26 102 0"/><path stroke-linecap="round" stroke-width="1.5" d="M94 72v7m-5-9.8v7m-5-9.8v7.1M79 64v7M63 57.7v7m-5-8.2v7m-5-7.8v7m-5-7.2v7m-5-6.7v7m-5-6.3v7m-5-5.8v7M17 64v7m-5-4.6v7m-5-4.2v7M2 72v7"/></svg>bridge</a></h1></div>
      <div>

        <div>
          <ul><li><a class="s110" href="https://bbpp222006.github.io/about/"> About </a></li><li><a class="s110" href="https://bbpp222006.github.io/archive/"> Posts </a></li><li><a class="s110" href="https://bbpp222006.github.io/tags/"> Tags </a></li><li><i type="reset" id="mode" class="js svgs adjust"></i></ul>
        </div>

        <div>
          <div>
            <form autocomplete=off class="js" name="goSearch" id="searchbox">
              <div class="searchd">
                <input id="searchinput" type="text" placeholder="Search" title="Search" />
                <button type="submit" title="Search" class="svgs search"></button>
              </div>
              <div class="results"><div id="suggestions"></div></div>
            </form>
          </div>
        </div>

      </div>
    </nav>
  </header>
  <main>
    <article>
      <h1><a href="https://bbpp222006.github.io/pt盒子配置记录/">pt盒子配置记录</a></h1>

      <span class="s95"> Glider <span class="rpad"></span> 九月 27, 2021 <span class="rpad"></span></span>

    


<h1 id="前言">前言</h1>
<p>之前发现墙上网口的带宽是千兆对等，心想岂不是可以用来刷pt？</p>
<p>于是开始研究pt圈子内部用的“盒子”配置</p>
<p>所谓“盒子/seedbox”，通常是指租的云服务器，具有以下特点</p>
<ol>
<li>大带宽，通常是上g</li>
<li>有公网ip，并且大部分早被各大pt站标记为“盒子”</li>
<li>用于下载各种pt资源，特别是刚出的热种，刷上传量</li>
</ol>
<p>通常的pt站点内，账号的上传量是最重要的，不仅可以用来提高分享率，还能够提高账户的等级，等级高到一定程度就不会因长时间不登录而删号，达到俗称的“毕业”</p>
<p>博主手头上有个4t的洋垃圾机械硬盘，还有一个之前做项目留下的树莓派4b（2g），便咸鱼了一个垃圾硬盘盒和几根千兆线，打算自建一个低配版的“盒子”</p>
<h1 id="正文">正文</h1>
<h2 id="树莓派4b的系统初始化和硬盘的挂载">树莓派4b的系统初始化和硬盘的挂载</h2>
<p>这部分详见以前的文章</p>
<h2 id="docker容器配置">docker容器配置</h2>
<p>本次盒子的配置采用deluge+flexget结合各种插件完成全自动刷上传的功能</p>
<p>以下所有操作，大硬盘均挂载于/mnt/disco_data下，仅供参考</p>
<h3 id="deluge">deluge</h3>
<p>先上docker配置：</p>
<pre class="z-code"><code><span class="z-text z-plain"> docker run -d  \
</span><span class="z-text z-plain">  --name=deluge  \
</span><span class="z-text z-plain">  -e PUID=1000   \
</span><span class="z-text z-plain">  -e PGID=1000   \
</span><span class="z-text z-plain">  -e TZ=Asia/Shanghai   \
</span><span class="z-text z-plain">  -e DELUGE_LOGLEVEL=error `#optional`    \
</span><span class="z-text z-plain">  --net=host   \
</span><span class="z-text z-plain">  -v  /mnt/disco_data/pt_config:/config   \
</span><span class="z-text z-plain">  -v /mnt/disco_data/pt_download:/downloads   \
</span><span class="z-text z-plain">  --restart unless-stopped   \
</span><span class="z-text z-plain">  ghcr.io/linuxserver/deluge
</span></code></pre>
<p>进去后默认密码是<code>deluge</code></p>
<p>修改默认下载目录：<img src="../images/2021-09-27-13-37-57.png" alt="" /></p>
<p>打开deamon连接端口，接下来flexget会用这个进行交互<img src="../images/2021-09-27-13-38-43.png" alt="" /></p>
<p>接着再在/mnt/disco_data/pt_config中新建plugins文件夹，把插件放进去
<img src="../images/2021-09-27-13-40-41.png" alt="" /></p>
<p>插件项目地址：</p>
<ul>
<li><a rel="noopener" target="_blank" href="https://github.com/ratanakvlun/deluge-ltconfig">ltconfig</a></li>
<li><a rel="noopener" target="_blank" href="https://github.com/omaralvarez/deluge-autoremoveplus/files/3312651/AutoRemovePlus-0.6.2-py3.7.zip">autoremove</a></li>
</ul>
<blockquote>
<p>autoremove这个插件好久没更新了，有老哥做了新版适配，并且给出了docker中的使用方法，这里是原讨论<a rel="noopener" target="_blank" href="https://github.com/omaralvarez/deluge-autoremoveplus/issues/50#issuecomment-526851615">链接</a>，所以下下来之后记得按照这个法子重命名一下</p>
</blockquote>
<p>放好插件之后重启一下deluge容器，再进去应该就能看到插件了
<img src="../images/2021-09-27-13-47-30.png" alt="" /></p>
<h4 id="ltconfig配置">ltconfig配置</h4>
<p>ltconfig插件是用来优化上传速度的，如果是正常的大内存机器，可以直接使用（high performance seed）模式，由于博主只有个丐版树莓派，所以需要调教一下</p>
<p>个人感觉最重要的就两项：cache_expiry和cache_size</p>
<p>我的设置如下：<img src="../images/2021-09-27-13-55-17.png" alt="" /></p>
<p>如果设置太大了，比如<a rel="noopener" target="_blank" href="https://blog.acesheep.com/index.php/archives/622/">这个博客</a>,容易爆内存，导致deluge容器被杀掉，虽然docker会帮你自动重启，但这样又得重新开始链接，比较慢。</p>
<p>此时内核报错如下：<code>dmesg</code>
<img src="../images/2021-09-27-13-58-09.png" alt="" /></p>
<p>我还找到了一份专门给树莓派4b用的配置文件<a rel="noopener" target="_blank" href="https://github.com/seedboxer/itconfigPI">链接</a></p>
<p>这份比较稳，适合当稳定的流媒体服务器使用，而我则是用来刷pt的，当然就应该在进程崩溃边缘反复横跳啦！</p>
<h4 id="autoremove配置">autoremove配置</h4>
<p><a rel="noopener" target="_blank" href="https://github.com/omaralvarez/deluge-autoremoveplus">官方配置说明</a></p>
<p>我的配置：
<img src="../images/2021-09-27-14-04-13.png" alt="" /></p>
<p>解释：下完后，做种3天（防止hr，opencd，说的就是你！）</p>
<h3 id="flexget">flexget</h3>
<p>docker配置：</p>
<pre class="z-code"><code><span class="z-text z-plain">docker run -d     \
</span><span class="z-text z-plain"> --name=flexget     \
</span><span class="z-text z-plain"> -p 5050:5050     \
</span><span class="z-text z-plain"> -v /mnt/disco_data/flexget_data:/data     \
</span><span class="z-text z-plain"> -v /mnt/disco_data/flexget_config:/config     \
</span><span class="z-text z-plain"> -e FG_WEBUI_PASSWD=AdminimdA?     \
</span><span class="z-text z-plain"> -e FG_LOG_LEVEL=info     \
</span><span class="z-text z-plain"> -e FG_LOG_FILE=flexget.log     \
</span><span class="z-text z-plain"> -e PUID=1000     \
</span><span class="z-text z-plain"> -e PGID=1000     \
</span><span class="z-text z-plain"> -e TZ=Asia/Shanghai     \
</span><span class="z-text z-plain"> wiserain/flexget
</span></code></pre>
<blockquote>
<p>FG_WEBUI_PASSWD这个设置你自己的密码，注意flexget默认需要很高强度的密码，如果启动失败，建议看一下启动的log，说不定就是说你的密码太弱了，不让启动……</p>
</blockquote>
<p>启动完成之后，进入5050端口的网页，输入密码
<img src="../images/2021-09-27-14-17-00.png" alt="" /></p>
<p>成功之后，开始配置flexget的插件</p>
<p>同样在/mnt/disco_data/flexget_config中新建plugins文件夹，把插件放进去</p>
<p><img src="../images/2021-09-27-14-18-48.png" alt="" /></p>
<p>插件地址：</p>
<ul>
<li><a rel="noopener" target="_blank" href="https://github.com/Juszoe/flexget-nexusphp">flexget-nexusphp</a> 用于高级过滤（免费，2x这种）</li>
<li><a rel="noopener" target="_blank" href="https://github.com/Juszoe/flexget-limiter">flexget-limiter</a> 用于限制种子下载，在硬盘或者带宽顶不住的时候，停止rss订阅</li>
</ul>
<h4 id="flexget整体配置">flexget整体配置</h4>
<p>因为插件加载后，全都在config中进行配置，这里我把自己的配置放出来，供读者借鉴，同时做个备份</p>
<pre class="z-code"><code><span class="z-text z-plain">web_server:
</span><span class="z-text z-plain">  bind: 0.0.0.0
</span><span class="z-text z-plain">  port: 5050
</span><span class="z-text z-plain">  web_ui: yes
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">templates:
</span><span class="z-text z-plain">   de:
</span><span class="z-text z-plain">    limit_new: 1
</span><span class="z-text z-plain">    limiter:
</span><span class="z-text z-plain">      wait: 10
</span><span class="z-text z-plain">      disk:
</span><span class="z-text z-plain">        write: 10240  # disk write speed KB/s
</span><span class="z-text z-plain">    content_size:
</span><span class="z-text z-plain">        min: 0
</span><span class="z-text z-plain">        max: 40960  #种子最大体积是40g
</span><span class="z-text z-plain">        strict: no
</span><span class="z-text z-plain">    deluge:
</span><span class="z-text z-plain">        host: 192.168.123.60 #填deluge的地址
</span><span class="z-text z-plain">        port: 58846
</span><span class="z-text z-plain">        username: localclient
</span><span class="z-text z-plain">        password: e3006f0f722e52949c1975c9b8a04c2874aa2a16   #这个看下面的解释
</span><span class="z-text z-plain">        path: /downloads
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">tasks:
</span><span class="z-text z-plain">  hdsky-task:
</span><span class="z-text z-plain">    rss:
</span><span class="z-text z-plain">      url: https://hdsky.me/torrentrss.php?rows=10&amp;linktype=dl&amp;passkey=xxxxxxxxxxxxxxxxxxxxxxxxxx
</span><span class="z-text z-plain">      other_fields:
</span><span class="z-text z-plain">        - link
</span><span class="z-text z-plain">    nexusphp:
</span><span class="z-text z-plain">      cookie: &#39;c_secure_uid=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#39;
</span><span class="z-text z-plain">      discount:
</span><span class="z-text z-plain">        - free
</span><span class="z-text z-plain">        - 2xfree
</span><span class="z-text z-plain">      seeders:
</span><span class="z-text z-plain">        min: 1
</span><span class="z-text z-plain">        max: 3
</span><span class="z-text z-plain">      leechers:
</span><span class="z-text z-plain">        min: 5
</span><span class="z-text z-plain">        max_complete: 0.2
</span><span class="z-text z-plain">      user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
</span><span class="z-text z-plain">  
</span><span class="z-text z-plain">    template: de
</span><span class="z-text z-plain">    
</span><span class="z-text z-plain">  ptertask:
</span><span class="z-text z-plain">    rss:
</span><span class="z-text z-plain">      url: https://pterclub.com/torrentrss.php?rows=10&amp;linktype=dl&amp;passkey=xxxxxxxxxxxxxxxxxxxxxxxx
</span><span class="z-text z-plain">      other_fields:
</span><span class="z-text z-plain">        - link
</span><span class="z-text z-plain">    nexusphp:
</span><span class="z-text z-plain">      cookie: &#39;c_secure_uid=xxxxxxxxxxxxxxxxxxxxx&#39;
</span><span class="z-text z-plain">      discount:
</span><span class="z-text z-plain">        - free
</span><span class="z-text z-plain">        - 2xfree
</span><span class="z-text z-plain">      seeders:
</span><span class="z-text z-plain">        min: 1
</span><span class="z-text z-plain">        max: 3
</span><span class="z-text z-plain">      leechers:
</span><span class="z-text z-plain">        min: 5
</span><span class="z-text z-plain">        max_complete: 0.1
</span><span class="z-text z-plain">      user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0
</span><span class="z-text z-plain">    
</span><span class="z-text z-plain">    template: de
</span><span class="z-text z-plain">  
</span><span class="z-text z-plain">  
</span><span class="z-text z-plain"> 
</span><span class="z-text z-plain">schedules:
</span><span class="z-text z-plain">  - tasks: hdsky-task
</span><span class="z-text z-plain">    interval:
</span><span class="z-text z-plain">      minutes: 10
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">  - tasks: ptertask
</span><span class="z-text z-plain">    interval:
</span><span class="z-text z-plain">      minutes: 10
</span></code></pre>
<p>deluge那里的密码在<code>&quot;/mnt/disco_data/pt_config/auth&quot;</code>这个文件里面</p>
<pre class="z-code"><code><span class="z-text z-plain">[root@alarmpi ~]# cat &quot;/mnt/disco_data/pt_config/auth&quot;
</span><span class="z-text z-plain">localclient:e3006f0f722e52949c1975c9b8a04c2874aa2a16:10
</span></code></pre>
<p>那么密码就是e3006f0f722e52949c1975c9b8a04c2874aa2a16</p>
<p>limiter配置选择硬盘写入作为判断，因为flexget和deluge处于不同的容器，网口不一样，flexget中读不到deluge的真实下载速度。我在flexget容器中写了个脚本，观测网络速度和硬盘写入速度，结果如下（单位都是M/s）：</p>
<p><img src="../images/2021-09-27-15-10-46.png" alt="" /></p>
<p>明显有数量级的差距，只能用硬盘写入来判断了。</p>
<h1 id="QA">QA</h1>
<p>deluge可能有时web页面登录不上去了，总显示密码错误。这时候试一下密码为空，说不定就能进了。</p>
<blockquote>
<p>触发原因：更新deluge配置时，火狐浏览器自动把空密码填到修改密码那一栏去了……然后就把密码改成了空</p>
</blockquote>
<h1 id="结尾">结尾</h1>
<p>之前用过qbit、tr，结合好多其他的方式配置盒子，甚至自己写过爬虫，尝试过滤出免费种。</p>
<p>后来网上冲浪时发现早有大手子写过了，果然还是不要造轮子的好。</p>
<p>flexget很早之前就听过，但一直嫌麻烦，最近闲下来了摸一摸，没想到一天就摸出来个大概，比想象中的简单多了，真香</p>
<p>所以不要小看脚本小子啊！有脚本小子当然也有脚本老子，只要能达成目标，就是大手子！</p>

      <nav>
        <div>
          <a href="https://bbpp222006.github.io/2021-10-6-搭建属于你自己的vpn/">&#8249; 搭建属于你自己的vpn</a>
        </div>
        <div>
          <a href="https://bbpp222006.github.io/linux下大容量硬盘配置/"> linux下大容量硬盘配置 &#8250;</a>
        </div>
      </nav>
    <script src="https://utteranc.es/client.js"
    repo="bbpp222006/bbpp222006.github.io"
    issue-term="pathname"
    theme="github-light"
    crossorigin="anonymous"
    async>
    </script>
    </article>
  </main>
  <footer>
    <hr />
    <div class="c">
      <nav><div><a type="application/atom+xml" href="https://bbpp222006.github.io/atom.xml" target="_blank" title="Glider的博客 Atom/RSS Feed"><i type="Button" class="svg rss" title="Glider的博客 Atom/RSS Feed"></i></a><a class="js m-protected" href="#emluYW5feGlhbmdAaHVzdC5lZHUuY24=" target="_blank" title="Mail"><i type="Button" class="svg mail" title="Mail"></i></a><a href="https://github.com/bbpp222006/" target="_blank" title="Github"><i type="Button" class="svg github" title="Github"></i></a></div></nav>
      <p class="s90"> &copy; <span id="year">2024</span> Glider的博客</p>
      <nav>
        <a class="s90" href="https://bbpp222006.github.io/about/"> About </a>
        <a class="s90" href="https://bbpp222006.github.io/contact/"> Contact </a>
        <a class="s90" href="https://bbpp222006.github.io/privacy/"> Privacy </a>
        <a class="s90" href="https://bbpp222006.github.io/sitemap.xml" target="_blank"> Sitemap </a>
      </nav>
      <p class="s90">Powered by <a href="https://www.getzola.org/" target="_blank">Zola</a> & <a href="https://github.com/jieiku/abridge/" target="_blank">Abridge</a></p>
    </div>
  </footer><span class="topout">
<span class="topleft"> </span><a href="#" class="top" title="Back to Top"><i class="svgs svgh angu"></i></a>
</span>
</body>
</html>
